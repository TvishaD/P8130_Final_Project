---
title: "Code and Analysis"
date: "2022-12-11"
output: github_document
---

```{r libraries set up, message = FALSE}
library(tidyverse)
library(ggplot2)
library(patchwork)
library(GGally)
```

```{r dataset set up}
bodyfat_df = 
  readxl::read_excel("body_density_data.xlsx") %>%
  janitor::clean_names() 

head(bodyfat_df)
```

```{r Y distribution exploration}
par(mfrow=c(1,3))

boxplot(bodyfat_df$bodyfat_brozek, main='bodyfat_brozek')
boxplot(bodyfat_df$bodyfat_siri, main='bodyfat_siri')
boxplot(bodyfat_df$body_density, main='bodyfat_density')

brozek = 
bodyfat_df %>%
  ggplot(aes(x = bodyfat_brozek)) +
  geom_histogram()

siri = 
bodyfat_df %>%
  ggplot(aes(x = bodyfat_siri)) +
  geom_histogram()

density =
bodyfat_df %>%
  ggplot(aes(x = body_density)) +
  geom_histogram()

brozek + siri + density
```

NOTE: All are approximately normal
* Probably going with Brozek. (60-92)

```{r checking validity in y choice}
bodyfat_df %>%
  ggplot(aes(x = age)) +
  geom_histogram()
```

```{r descriptive stats of variables}
bodyfat_df %>% 
  select(-id, -bodyfat_siri, -body_density) %>% 
  gtsummary::tbl_summary() %>% 
  gtsummary::bold_labels()
```

```{r normality, y-x rels, collinearity in covariates (xs)}
bodyfat_df %>% 
  select(-bodyfat_siri, -body_density, -id) %>% 
  relocate("bodyfat_brozek") %>% 
  ggpairs()
```

```{r inv_transformation for weight}
before = 
bodyfat_df %>%
  ggplot(aes(x = weight)) +
  geom_density()

after = 
bodyfat_df %>% 
  mutate(inv_weight = 1/(weight)) %>% 
  ggplot(aes(x = inv_weight)) +
  geom_density()

before + after
```

NOTE: For the almost normal but right skewed distributions, inverse transformation is making a considerable difference. From this point, inversely transforming (weight and neck --- bicep). 

```{r inverse transforms}
bodyfat_df = 
  bodyfat_df %>%
  mutate(i_weight = 1/weight,
         i_neck = 1/neck,
         i_chest = 1/chest,
         i_abdomen = 1/abdomen,
         i_hip = 1/hip,
         i_thigh = 1/thigh,
         i_knee = 1/knee,
         i_ankle = 1/ankle,
         i_bicep = 1/bicep) %>% 
  select(-id, -bodyfat_siri, -body_density, -weight, -neck, -chest, -abdomen,
         -hip, -thigh, -knee, -ankle, -bicep)

```


NOTE: Collinearity continues though. Weight with all others. Just fyi. Not manually removing any covariates as they would be removed during the model selection processes?



